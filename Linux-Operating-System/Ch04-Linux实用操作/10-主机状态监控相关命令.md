# `top` 命令

查看CPU、内存使用情况，类似Windows的任务管理器。

默认每5秒刷新一次，语法：

```bash
top
```

按 q 或 ctrl+c 退出。

### 各列指标解释：

_ PID ：进程ID。

_ USER ：进程所属用户。

_ PR ：进程优先级，越小越高。

_ NI ：负值表示高优先级，正值表示低优先级。

- VIRT ：进程使用的虚拟内存，单位KB。

- RES ：进程使用的物理内存，单位KB。

- SHR ：进程使用的共享内存，单位KB。

- S ：进程状态(S休眠，R运行，Z僵死状态，N负数优先级，I空闲状态)。

- %CPU ：进程的CPU占用率。

- %MEM ：进程的内存占用率。

- TIME+ ：进程使用的CPU时间总计，单位10毫秒。

- COMMAND ：进程的命令或名称或程序文件路径。

### `top` 命令支持的选项

`[-p]` ：显示某个进程的信息。

`[-d]` ：设置刷新时间，默认5秒。

`[-c]` ：显示产生进程的完整命令，默认是进程名。

`[-n]` ：指定刷新次数，比如 `top -n 3` ，刷新3次后退出。

`[-b]` ：以非交互非全屏模式运行，以批次的方式执行 `top` 一般配合 `-n` 指定输出几次统计信息，将输出重定向到文件，比如 `top -b -n 3 > /tmp/top.tmp` 。

`[-i]` ：不显示任何闲置(idle)或僵尸(zombie)进程。

`[-u]` ：查找特定用户启动的进程。

例如：

```bash
top -p 1 # 显示PID为1的进程

top -d 3 # 设置三秒刷新一次

top -c # 显示产生进程的完整命令

top -n 3 # 刷新3次后自动退出

top -u username # 显示指定用户的进程

```

### `top` 交互式运行

不加上 `[-b]` 选项时是交互式运行。

| 按键 |              作用               |
| :----: | :-----------------------------: |
|   h    |   显示帮助画面    |
|   c    |   显示进程的完整命令，即 `-c` 再次按下又恢复默认   |
|   f    |   选择需要展示的项目    |
|   M    |   根据驻留内存大小(RES)排序    |
|   P    |   根据CPU占用率排序   |
|   T    |   根据时间/累计时间排序   |
|   E    |   切换顶部内存显示单位    |
|   e    |   切换进程内存显示单位  |
|   l    |   切换显示平均负载和启动时间信息    |
|   i    |   不显示闲置或无用进程，即 `-i` 再次按下又恢复默认    |
|   t    |   切换显示CPU状态信息   |
|   m    |   切换显示内存信息   |

# `df` 命令

查看硬盘的使用情况，语法：

```bash
df [-h]
```

`[-h]` ：以更加人性化的单位显示。

# `iostat` 命令

查看CPU、磁盘的相关信息，语法：

```bash
iostat [-x] [num1] [num2]
```

`[-x]` ：显示更多信息。

`[num1]` ：数字，刷新间隔。

`[num2]` ：数字，刷新几次。

输入 `iostat` 的结果：

![](iostat命令CPU相关信息.png)

输入 `iostat -x` 的结果：

![](iostat命令-x选项.png)

各个指标解释：

- rrqm/s： 每秒这个设备相关的读取请求有多少被Merge了（当系统调用需要读取数据的时候，VFS将请求发到各个FS，如果FS发现不同的读取请求读取的是相同Block的数据，FS会将这个请求合并Merge, 提高IO利用率, 避免重复调用）；

- wrqm/s： 每秒这个设备相关的写入请求有多少被Merge了。

- r/s： 每秒读取的扇区数。

- w/s： 每秒写入的扇区数。

- rKB/s： 每秒发送到设备的读取请求数。

- wKB/s： 每秒发送到设备的写入请求数。

- avgrq-sz  平均请求扇区的大小。

- avgqu-sz  平均请求队列的长度。毫无疑问，队列长度越短越好。  

- await：  每一个IO请求的处理的平均时间（单位是微秒毫秒）。

- svctm   表示平均每次设备I/O操作的服务时间（以毫秒为单位）。

- %util：  磁盘利用率。
