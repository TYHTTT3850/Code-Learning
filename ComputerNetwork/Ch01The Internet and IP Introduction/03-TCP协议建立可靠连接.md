绝大部分数据包是通过TCP协议发送的，为了确保通信双方都准备好发送和接收数据，TCP通过三次握手建立可靠连接。

### 三次握手过程（Three-Way Handshake）

#### 场景：客户端（Client）想与服务器（Server）建立TCP连接。


#### 第一次握手（SYN）

- **客户端**发送一个**SYN（同步）报文段**，表示请求建立连接。
- 包含：
  - SYN=1
  - 初始序列号 `seq = x`

客户端 → 服务器：`SYN, seq = x`


#### 第二次握手（SYN + ACK）

- **服务器**收到客户端的SYN后，**确认收到请求**，并**发回一个 SYN+ACK（确认） 报文段**。
- 包含：
  - ACK=1，`ack = x+1`（确认客户端的SYN）
  - SYN=1，`seq = y`（服务器自己的初始序列号）

服务器 ← 客户端：`SYN=1, ACK=1, seq = y, ack = x+1`


#### 第三次握手（ACK）

- **客户端**收到服务器的SYN+ACK后，发送一个**确认ACK报文段**。
- 包含：
  - ACK=1，`ack = y+1`（确认服务器的SYN）
  - `seq = x+1`（上次的序列号 + 1）

客户端 → 服务器：`ACK, seq = x+1, ack = y+1`

### 握手完成后：

- 客户端和服务器都知道：
  - 对方的存在
  - 对方的初始序列号（用于后续有序传输）
- **连接正式建立，可以双向发送数据。**

### 为什么需要三次？

| 步骤   | 目的                                                 |
| ------ | ---------------------------------------------------- |
| 第一次 | 客户端确认自己能发，通知服务器自己准备好了           |
| 第二次 | 服务器确认收到客户端的请求，也通知客户端自己准备好了 |
| 第三次 | 客户端确认收到服务器的响应，连接正式建立             |